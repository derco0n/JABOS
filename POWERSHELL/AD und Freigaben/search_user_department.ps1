<#
Searches for AD-Users of a specific department.
D. MaienhÃ¶fer, 2021/11
#>
param(
    [String]$department=""
)
if ($department -eq ""){
    Write-host "Please specifiy -department"
    exit 1
}
$allusers=Get-ADuser -filter * -properties samaccountname,mail,title,givenname,surname,telephoneNumber,department,description,manager,l | select-object samaccountname,mail,title,givenname,surname,telephoneNumber,department,description,manager,l
[System.Collections.ArrayList]$results= @()
$found=$false
foreach ($user in $allusers){
    if ($user.department -Match $department){
        $null=$results.Add($user)
        $found = $true
    }
}
if ($found){
    $results | select-object samaccountname,mail,title,givenname,surname,telephoneNumber,department,description,l,@{n="Vorgesetzter";e={get-aduser $_.manager | select -ExpandProperty name}} | ft -Property *
}
else {
    write-host ("Unable to find department `"" + $department + "`"")
}

# SIG # Begin signature block
# MIITYwYJKoZIhvcNAQcCoIITVDCCE1ACAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUQwmqNestbP0zMyfv6d/VH4al
# qLGggg/XMIIHeTCCBWGgAwIBAgIKGCSiEAAAAAAAAjANBgkqhkiG9w0BAQsFADAU
# MRIwEAYDVQQDEwlQT1JUQUwtQ0EwHhcNMTUxMTAzMDcxNDQxWhcNMjUxMDMwMDgy
# MjU4WjBHMRMwEQYKCZImiZPyLGQBGRYDa2xnMRYwFAYKCZImiZPyLGQBGRYGcG9y
# dGFsMRgwFgYDVQQDEw9QT1JUQUxQS0ktU3ViQ0EwggIiMA0GCSqGSIb3DQEBAQUA
# A4ICDwAwggIKAoICAQCgICeRIo2o073jRxKD2z7YKixgeTQ2UCyI7BJUWdlcDqUF
# R1xWyEIEMdU49/VykdV0kZ3axtTsPEBGS+Ce6QVtHRt7QKoz6vn9UHsBLJmSG9XE
# VHLo2X7dGZSs71KYiPVP3LP+4/Zok2xR69N3IXsrGzsXIbBAtWE4Rk22kwyGzSVt
# 7s0ozfh26bvkX8SpjD4pyjEmoY24PNYg05US4gNDpwDjCZiqy/9OFgztmIzn6lng
# sK8ZYCbnPt6w8bCO7cuF+ffaPSCH7wijZRbCG2+FrkwyVwQIElpx4fpizkys+qG4
# rWGsyOf+8LlfJYzWGVIySKqYd1aEf+fCtS5jXy9MXb49eiXFtuSmtPbYGcMEIq9I
# SdrvbecUQxJjMngN8Y0EN1hmYngPBJh5RiK5RK+DN0gPUPfXYAviGbht91AEhk+O
# aacLkCtiX/oARBjiIH0d8MW5OC7TsOt3aJT48HXwJ9qkzoa37SFeX8tz0O3gjP3/
# AAntxvieWEeAL35NeUaKOgdEFwMS33LLefICxpyjd5KwV+PJc1TFNFwglLhiY4IX
# s12Sd9xlaDYMIkyaWaWmYDVluFk/i8lJ0I90aFTU0EzDFw2graqa1B8JoXnn31XE
# 1D+exvXKa7y1MWPYy3xUixoF1MYyV8qGEu0DGzWOLOaQbW7pGL5mfq09xq2kYwID
# AQABo4ICmDCCApQwEAYJKwYBBAGCNxUBBAMCAQAwHQYDVR0OBBYEFHWW1PEdWYel
# TIyUQfasdpPFfrxPMBkGCSsGAQQBgjcUAgQMHgoAUwB1AGIAQwBBMAsGA1UdDwQE
# AwIBhjAPBgNVHRMBAf8EBTADAQH/MB8GA1UdIwQYMBaAFO6zQpTRmjvL3g0mN9kQ
# G903+ql+MIH9BgNVHR8EgfUwgfIwge+ggeyggemGgbBsZGFwOi8vL0NOPVBPUlRB
# TC1DQSxDTj1wb3J0YWxjYSxDTj1DRFAsQ049UHVibGljJTIwS2V5JTIwU2Vydmlj
# ZXMsQ049U2VydmljZXMsQ049Q29uZmlndXJhdGlvbixEQz1wb3J0YWwsREM9a2xn
# P2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RDbGFzcz1jUkxE
# aXN0cmlidXRpb25Qb2ludIY0aHR0cDovL3BvcnRhbGNhLmtsaW5pa3VtLWxpcHBl
# LmRlL2NlcnQvUE9SVEFMLUNBLmNybDCCAQUGCCsGAQUFBwEBBIH4MIH1MIGnBggr
# BgEFBQcwAoaBmmxkYXA6Ly8vQ049UE9SVEFMLUNBLENOPUFJQSxDTj1QdWJsaWMl
# MjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERD
# PXBvcnRhbCxEQz1rbGc/Y0FDZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENsYXNzPWNl
# cnRpZmljYXRpb25BdXRob3JpdHkwSQYIKwYBBQUHMAKGPWh0dHA6Ly9wb3J0YWxj
# YS5rbGluaWt1bS1saXBwZS5kZS9jZXJ0L3BvcnRhbGNhX1BPUlRBTC1DQS5jcnQw
# DQYJKoZIhvcNAQELBQADggIBAGG0fbbWhQxJwIXevUVL0DZZGXRIpPlwXQ6iy+yk
# CmyfOGJL2/HO45r7fRJBc2hOdEHDeZUPcLcPlCryburUb/wwV0ww66/EcHG06B3L
# seG5dUw3BB81edzJV9jEoOEYhPuHDUep2lWPmWF2yo40O8l600EeUKymg4gh2aKT
# F6DrpOahHeDaiZ50mjfFqJmmY3ed0nYSZcMF69dAQd24VVUmLnFeLhd2kwgL3Fei
# AImiSGNVoBJipuZy6LOWmu1mhPy31Yxbss8XYWcoRGf8WCB+2Uk1FJh16fw12vZk
# 70Nuj25AVBb9DoASsg3rvvsw0v4znPFRqFpQT6uBgo6kkAW0FlwVW/95I+2QkjkX
# nvwG+4Zl+qNyLicM4ydwLYZbnDka5xQp4HFqjUkCFde8gWogS4rGQpJFYlQ5Tj63
# 1G83vZFNyOrH1m9aJGudSGSBNzs6Djcr/h8sDe1TCJcXDRlhmDZxAogUB66oAgmL
# SP9/joRDo9EOMIbIbRra5Su3rn+72T3p6N2riedP+yiCfcSVg8fJLlsuO9zSsWHI
# 3qS/8W725GqN+TgFdSDtJRTQDnqwK9i9okRsRvyUvf8ZUlpYu4N7euytn1jecNfx
# Lbqn+/0MkXzrUksh04QKaD5voIbhVplucw6jPZi9BOtLtWIatGnbifshjg7qnBhq
# jb6XMIIIVjCCBj6gAwIBAgIKdox2awAAAAABAjANBgkqhkiG9w0BAQsFADBHMRMw
# EQYKCZImiZPyLGQBGRYDa2xnMRYwFAYKCZImiZPyLGQBGRYGcG9ydGFsMRgwFgYD
# VQQDEw9QT1JUQUxQS0ktU3ViQ0EwHhcNMjEwNzI4MTE0MTU4WhcNMjMwNzI4MTE0
# MTU4WjBfMRMwEQYKCZImiZPyLGQBGRYDa2xnMRYwFAYKCZImiZPyLGQBGRYGcG9y
# dGFsMRowGAYDVQQLExFDZXJ0aWZpY2F0ZU93bmVyczEUMBIGA1UEAxMLRGVubmlz
# IE1hcngwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCh5XFP9+zJtf+l
# GHEgT22YIWTH1+g3Go/Yel5gP7Hfvs0CsunHUilVBR+Ksdzn8/3/rhcBao0itKVb
# qoDptUzoWVGIqYnZsK1kEcdwbbo9BfDnwvYlXI39AaSfYMIh33dLyTg5lhHNRXN+
# xOJs5CnnuWKw4SkFcC8Bzn7LSClxZ8d9Xq8vVFaiAr/VXyhaqTdhj6Klutm+Idcq
# 3BDWxJ3eD8KiqyuHjDfmIZvQFcQvbgMyZ0PwXzwtnKsAdzxIcHVBSQ1fu+T91KhL
# MBxxHEmrkbmJCnhdAcAypzy6kEgep1pu+OmVMVnOGnkdFqyu62jhz7LJ5narfBAY
# AIkjRKO1ue+GbzkOy+SUpSkHWPxm/zJnRmmlwMN/GBJawVw+fZ2IRKraMgFWHFw2
# fPizduo3QvJGYBqooeJpG8OswqIqJJVKuo8ax1O1bC6swx7G9o/HFx3lCCLHTM9R
# XbVSK/nSv8K8OK5ZRkL8L8JwWicpxk32DdaQ4VdJXMSm/eKPjE3DJPYxhwkFRSDK
# /bEvH/IzyUOIJVBUO3TkaEgOcMLCi8l5+75oayoftpmIUMHov3RnmW3sittS7Ukq
# 9BGhjbAU7khOAc9lr/pOTNabEc+45tPFyLw0GvCO0rwWwsi9vNJOFLmr4CAdMMJ+
# ebeSnTp4HQ+koJ1nr1sCMk8yH7lJcQIDAQABo4IDKjCCAyYwDgYDVR0PAQH/BAQD
# AgeAMD0GCSsGAQQBgjcVBwQwMC4GJisGAQQBgjcVCIPX9naGsug5hfGDJIOW/xWx
# pzyBFoKdyCqDp5JsAgFkAgECMB0GA1UdDgQWBBSLAVwySO9uZJxstCzJMKL8jPpp
# 0DAfBgNVHSMEGDAWgBR1ltTxHVmHpUyMlEH2rHaTxX68TzCCAQsGA1UdHwSCAQIw
# gf8wgfyggfmggfaGgbdsZGFwOi8vL0NOPVBPUlRBTFBLSS1TdWJDQSxDTj1QT1JU
# QUxQS0ksQ049Q0RQLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZp
# Y2VzLENOPUNvbmZpZ3VyYXRpb24sREM9cG9ydGFsLERDPWtsZz9jZXJ0aWZpY2F0
# ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9u
# UG9pbnSGOmh0dHA6Ly9wb3J0YWxjYS5rbGluaWt1bS1saXBwZS5kZS9jZXJ0L1BP
# UlRBTFBLSS1TdWJDQS5jcmwwggEfBggrBgEFBQcBAQSCAREwggENMIGtBggrBgEF
# BQcwAoaBoGxkYXA6Ly8vQ049UE9SVEFMUEtJLVN1YkNBLENOPUFJQSxDTj1QdWJs
# aWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9u
# LERDPXBvcnRhbCxEQz1rbGc/Y0FDZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENsYXNz
# PWNlcnRpZmljYXRpb25BdXRob3JpdHkwWwYIKwYBBQUHMAKGT2h0dHA6Ly9wb3J0
# YWxjYS5rbGluaWt1bS1saXBwZS5kZS9jZXJ0L1BPUlRBTFBLSS5wb3J0YWwua2xn
# X1BPUlRBTFBLSS1TdWJDQS5jcnQwEwYDVR0lBAwwCgYIKwYBBQUHAwMwGwYJKwYB
# BAGCNxUKBA4wDDAKBggrBgEFBQcDAzAxBgNVHREEKjAooCYGCisGAQQBgjcUAgOg
# GAwWZGVubmlzLm1hcnhAcG9ydGFsLmtsZzANBgkqhkiG9w0BAQsFAAOCAgEAiSVu
# 6t4iy5fEJLpXB+uU6SttnBS3+OyMdkHbnOXivlXqyPGSyWFf03wxCPxfBSrHRyiO
# RuklEB2f7SiYIJ21IEZqbfTRIyvJHBZWkx3DP6NOgDuu0YfZKOtiplELxn1435DS
# bn2mr4sHjaX4gjBofHcUTp1NmRoGl8diWUTJsoGwQRgUnoyvTfrJj6i9LDQgEonj
# uq0zNCsDYTsgVC7XsFbIIxF0/R6W7ol2xFtVmGP0Wx34DRNTuACk5HHeGy2kCYYq
# 0SDYHwhHna2IZ9PWyjlzBwY7o9TBpaHsfJeB7k/sWJ8SZ2dReG6oTH36NMkYmIwN
# 6R45q7fU4g5uVeB0T7EKdbb3YmkwRhd0TKPtPYgXgR2EQmmQsflFgc76fkxey014
# R47BycJoY50XL/1rad+TwlTcJv6sTzQwyqwaiyWfgGBlFUdxqPbjqTWQnJoNtJhE
# rm442DSgfeBoUl6ZEVLp9w+E66kADBP4qZ2LCcbvmhAt+xzyUpTxdcCVYhVBY7wf
# KK2h6WWff8iBOrOxw1/V0p9JmBpaqnzaAE4/3bMIlurm9SUT3A6BZoSQdRPr/pnf
# XqfwfhO9uYvrgSJGC5ec/Nw9TPfQtBrpejy11Nuh//ZK/Y6NeT51WQG0wINPqV6u
# MJrIsqGlvj3K1Vae9CNgy8vI42bnnwn2dwrSCFkxggL2MIIC8gIBATBVMEcxEzAR
# BgoJkiaJk/IsZAEZFgNrbGcxFjAUBgoJkiaJk/IsZAEZFgZwb3J0YWwxGDAWBgNV
# BAMTD1BPUlRBTFBLSS1TdWJDQQIKdox2awAAAAABAjAJBgUrDgMCGgUAoHgwGAYK
# KwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIB
# BDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAjBgkqhkiG9w0BCQQxFgQU
# Abqw8vy4k9StAvMwV7VBPFzEqbAwDQYJKoZIhvcNAQEBBQAEggIARLU6B/iKTeN6
# wpOwysVVJatIC14FFith+FrbUwALO9qMAeoRElm3Zs8rwpcbhE0eUxnRflvjzBry
# YP3E7CuyDsxm4Ga59cKNoHYbor4MPvfy5Ur9TG+L0wkacRcn4BuvJl5gtoPVoMsv
# Tm9TeRHZ5bO0lqqqcS01ZKUNorGYJdk50trx5IFslHZi+55PSjn4hZv3UHY56qzH
# CVdTtP3yMs72VEIoUUyTv5qAgDqCVoEQgLI0bCYfxIND4hJUTaB5V3eJh2tm223O
# r2l8MiWU6/mpgc7MZZkXjhpVjeV2C44cVAQv4LI/F0cxvTjXj6YonX+VNpgr8Iz+
# gyzFUIuvz4gst/huSYeQ1Cy07+7RUoss35QF6YkdaIre9B02xJxzZUXCKyqhBLhv
# ISTW/QCKGc7qs0xvZZmcnq8fR+rGcotgabURlhrKfL3lnWaARaS5bJKq9KwjUbRn
# tA76N2Lq9YRxswMFPRW2kf8nkT8aqarZshoNLYsfeNpwVz+9Vi75LUDKYx6HNLnH
# Bi9NAyHx0EC1exBDB//s47X4w9tun0y/qFwzrqU0ZND/EYQn1AWWLNT3Ozp1dLy8
# XpRMk8+n3RyhmNql5o0URW3/tljRz0hWrAlRqbDB7y0TqZcsj0QxpyPv/rlzshHQ
# 8t948HL5MVOp8YxkWLtSSOdPbw86QL8=
# SIG # End signature block
